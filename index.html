<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Teacher ‚Äî ‡§∞‡§æ‡§ú‡•Ç ‡§∞‡§æ‡§Æ | Free Education for All üáÆüá≥</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* ===== HOME LAYOUT ===== */
    .home-hero {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      align-items: center;
      padding: 40px 0 20px;
      max-width: 1100px;
      margin: 0 auto;
      padding-left: 20px;
      padding-right: 20px;
    }

    /* ===== AVATARS SECTION ===== */
    .avatars-section {
      display: flex;
      gap: 24px;
      justify-content: center;
      align-items: flex-end;
    }

    .avatar-box {
      text-align: center;
      position: relative;
    }

    .avatar-photo {
      width: 140px; height: 140px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid var(--primary);
      box-shadow: 0 0 30px rgba(233,69,96,0.4);
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%,100% { transform:translateY(0); }
      50%      { transform:translateY(-10px); }
    }

    .avatar-label {
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
      font-weight: 600;
    }

    /* ===== AI AVATAR CANVAS ===== */
    #aiCanvas {
      border-radius: 50%;
      border: 4px solid var(--gold);
      box-shadow: 0 0 30px rgba(244,196,48,0.4);
      animation: floatAI 3s ease-in-out infinite 1.5s;
      cursor: pointer;
    }

    @keyframes floatAI {
      0%,100% { transform:translateY(0); }
      50%      { transform:translateY(-10px); }
    }

    .speaking-indicator {
      display: none;
      font-size: 12px;
      color: var(--gold);
      margin-top: 6px;
      animation: blink 1s ease-in-out infinite;
    }
    @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }
    .speaking-indicator.active { display: block; }

    /* ===== HERO TEXT ===== */
    .hero-text h1 {
      font-size: 36px;
      font-weight: 800;
      line-height: 1.3;
      margin-bottom: 14px;
    }
    .hero-text h1 span { color: var(--primary); }
    .hero-text p {
      font-size: 16px;
      color: var(--muted);
      line-height: 1.7;
      margin-bottom: 20px;
    }
    .hero-badges { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:20px; }
    .badge {
      background: var(--dark3);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 5px 14px;
      font-size: 12px;
      font-weight: 600;
      color: var(--muted);
    }

    /* ===== ASK SECTION ===== */
    .ask-section {
      max-width: 780px;
      margin: 0 auto 30px;
      padding: 0 20px;
    }

    .ask-box {
      background: var(--dark2);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      transition: border-color 0.3s;
    }
    .ask-box:focus-within { border-color: var(--primary); }

    .ask-input-row {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    #questionInput {
      flex: 1;
      background: transparent;
      border: none;
      font-size: 16px;
      color: var(--text);
      font-family: 'Hind', sans-serif;
      outline: none;
      padding: 8px 0;
    }
    #questionInput::placeholder { color: var(--muted); }

    .mic-btn {
      width: 44px; height: 44px;
      border-radius: 50%;
      border: none;
      background: var(--dark3);
      color: var(--text);
      font-size: 20px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex; align-items:center; justify-content:center;
      flex-shrink: 0;
    }
    .mic-btn:hover     { background: var(--dark2); border: 1px solid var(--primary); }
    .mic-btn.listening { background: var(--primary); animation: pulse 1s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.1)} }

    .ask-btn {
      background: linear-gradient(135deg, var(--primary), var(--primary2));
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 30px;
      font-size: 15px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.3s;
      white-space: nowrap;
    }
    .ask-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(233,69,96,0.4); }

    /* ===== ANSWER SECTION ===== */
    .answer-section {
      max-width: 780px;
      margin: 0 auto 24px;
      padding: 0 20px;
      display: none;
    }

    .answer-card {
      background: var(--dark2);
      border: 1px solid var(--border);
      border-left: 4px solid var(--primary);
      border-radius: 14px;
      padding: 20px;
    }

    .answer-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
      font-size: 13px;
      color: var(--muted);
      font-weight: 600;
    }

    #answerText {
      font-size: 15px;
      line-height: 1.8;
      color: var(--text);
    }

    .audio-controls {
      display: flex;
      gap: 8px;
      margin-top: 14px;
      flex-wrap: wrap;
    }

    /* ===== SEARCH SECTION ===== */
    .search-section {
      max-width: 780px;
      margin: 0 auto 30px;
      padding: 0 20px;
    }

    .search-input-row {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
    }

    .search-results {
      display: none;
      background: var(--dark2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px;
      max-height: 380px;
      overflow-y: auto;
    }

    .search-item {
      background: var(--dark3);
      border-radius: 10px;
      padding: 12px 14px;
      margin-bottom: 8px;
      border-left: 3px solid var(--blue);
      cursor: pointer;
      transition: all 0.2s;
    }
    .search-item:hover { transform: translateX(3px); border-left-color: var(--primary); }
    .search-item.wiki  { border-left-color: var(--gold); }
    .search-item h4    { font-size: 14px; color: #74b9ff; margin-bottom: 4px; }
    .search-item p     { font-size: 12px; color: var(--muted); line-height: 1.5; margin-bottom: 4px; }
    .search-item a     { font-size: 11px; color: var(--green); word-break: break-all; }
    .wiki-badge {
      background: #3366cc;
      color: white;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 8px;
      border-radius: 10px;
      margin-bottom: 6px;
      display: inline-block;
    }

    .section-label {
      font-size: 14px;
      font-weight: 700;
      color: var(--muted);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* ===== MOBILE ===== */
    @media (max-width: 768px) {
      .home-hero {
        grid-template-columns: 1fr;
        text-align: center;
        padding: 24px 16px;
        gap: 20px;
      }
      .avatars-section { justify-content: center; }
      .hero-badges { justify-content: center; }
      .hero-text h1 { font-size: 26px; }
    }
  </style>
</head>
<body>
  <div id="nav-placeholder"></div>

  <!-- HERO SECTION -->
  <div class="home-hero">
    <!-- Avatars -->
    <div class="avatars-section">
      <div class="avatar-box">
        <img src="photo.jpg" alt="Raju Ram" class="avatar-photo" id="teacherPhoto"
             onerror="this.src='https://api.dicebear.com/7.x/avataaars/svg?seed=RajuRam'" />
        <div class="avatar-label">üßë‚Äçüè´ ‡§∞‡§æ‡§ú‡•Ç ‡§∞‡§æ‡§Æ</div>
      </div>
      <div class="avatar-box">
        <canvas id="aiCanvas" width="140" height="140"></canvas>
        <div class="speaking-indicator" id="speakingDot">üîä ‡§¨‡•ã‡§≤ ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç...</div>
        <div class="avatar-label">ü§ñ AI Avatar</div>
      </div>
    </div>

    <!-- Hero Text -->
    <div class="hero-text">
      <h1>‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§π‡•Ç‡§Ç<br><span>‡§∞‡§æ‡§ú‡•Ç ‡§∞‡§æ‡§Æ</span> ‚Äî ‡§Ü‡§™‡§ï‡§æ AI ‡§ó‡•Å‡§∞‡•Å‡§ú‡•Ä üôè</h1>
      <p>‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§∏‡§µ‡§æ‡§≤ ‡§™‡•Ç‡§õ‡•ã ‚Äî ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§ú‡§µ‡§æ‡§¨ ‡§™‡§æ‡§ì‡•§ ‡§Ü‡§µ‡§æ‡§ú‡§º ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§®‡•ã‡•§ Quiz ‡§ñ‡•á‡§≤‡•ã‡•§ ‡§î‡§∞ TeamCoins ‡§≠‡•Ä ‡§ï‡§Æ‡§æ‡§ì!</p>
      <div class="hero-badges">
        <span class="badge">üÜì ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§Æ‡•Å‡§´‡•ç‡§§</span>
        <span class="badge">üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç</span>
        <span class="badge">üé§ Voice Support</span>
        <span class="badge">üèÜ TeamCoin Rewards</span>
      </div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <a href="quiz.html"    class="btn btn-primary btn-lg">üß† Quiz ‡§ñ‡•á‡§≤‡•ã</a>
        <a href="courses.html" class="btn btn-outline  btn-lg">üìö Courses ‡§¶‡•á‡§ñ‡•ã</a>
      </div>
    </div>
  </div>

  <!-- ASK SECTION -->
  <div class="ask-section">
    <div class="section-label">‚ùì ‡§∏‡§µ‡§æ‡§≤ ‡§™‡•Ç‡§õ‡•ã ‚Äî AI Teacher ‡§ú‡§µ‡§æ‡§¨ ‡§¶‡•á‡§ó‡§æ!</div>
    <div class="ask-box">
      <div class="ask-input-row">
        <input type="text" id="questionInput"
               placeholder="‡§Ø‡§π‡§æ‡§Å ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§∏‡§µ‡§æ‡§≤ ‡§≤‡§ø‡§ñ‡•ã ‡§Ø‡§æ üé§ ‡§¨‡•ã‡§≤‡•ã..." />
        <button class="mic-btn" id="micBtn" onclick="toggleMic()" title="Voice Input">üé§</button>
        <button class="ask-btn" onclick="askTeacher()">‡§™‡•Ç‡§õ‡•ã ‚û§</button>
      </div>
      <div id="micStatus" style="font-size:12px;color:var(--muted);margin-top:6px;display:none">
        üé§ ‡§¨‡•ã‡§≤‡•ã... (‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Ø‡§æ English)
      </div>
    </div>
  </div>

  <!-- ANSWER SECTION -->
  <div class="answer-section" id="answerSection">
    <div class="answer-card">
      <div class="answer-header">
        <span>ü§ñ</span>
        <span>‡§∞‡§æ‡§ú‡•Ç ‡§∞‡§æ‡§Æ ‡§ï‡§æ ‡§ú‡§µ‡§æ‡§¨</span>
        <span id="searchSource" style="margin-left:auto;background:var(--dark3);padding:2px 10px;border-radius:10px;font-size:11px"></span>
      </div>
      <div id="answerText" style="color:var(--muted)">‡§∏‡•ã‡§ö ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç... ‚è≥</div>
      <div class="audio-controls">
        <button class="btn btn-sm btn-outline" onclick="replayAudio()">üîä ‡§´‡§ø‡§∞ ‡§∏‡•Å‡§®‡•ã</button>
        <button class="btn btn-sm btn-outline" onclick="stopAudio()">‚èπ ‡§∞‡•ã‡§ï‡•ã</button>
        <button class="btn btn-sm btn-outline" onclick="speakBrowser()">üó£Ô∏è Browser Voice</button>
      </div>
    </div>
  </div>

  <!-- SEARCH SECTION -->
  <div class="search-section">
    <div class="section-label">üîç Web Search</div>
    <div class="search-input-row">
      <input type="text" class="input" id="searchInput" placeholder="‡§ï‡•Å‡§õ ‡§≠‡•Ä search ‡§ï‡§∞‡•ã..." />
      <button class="btn btn-primary" onclick="doSearch()">Search</button>
    </div>
    <div class="search-results" id="searchResults"></div>
  </div>

  <div id="footer-placeholder"></div>
  <script src="nav.js"></script>
  <script>
    // ===== AI AVATAR (Canvas) =====
    const canvas  = document.getElementById("aiCanvas");
    const ctx     = canvas.getContext("2d");
    let mouthOpen = 0;
    let eyeBlink  = 0;
    let blinkTimer= 0;
    let headBob   = 0;

    function drawAvatar() {
      ctx.clearRect(0, 0, 140, 140);
      const cx = 70, cy = 70 + Math.sin(headBob) * 2;

      // Face
      const grad = ctx.createRadialGradient(cx, cy-10, 20, cx, cy, 60);
      grad.addColorStop(0, "#fde68a");
      grad.addColorStop(1, "#f59e0b");
      ctx.beginPath();
      ctx.arc(cx, cy, 55, 0, Math.PI*2);
      ctx.fillStyle = grad;
      ctx.fill();

      // Turban
      ctx.beginPath();
      ctx.ellipse(cx, cy-42, 38, 18, 0, Math.PI, 0);
      ctx.fillStyle = "#e94560";
      ctx.fill();
      ctx.beginPath();
      ctx.arc(cx, cy-52, 10, 0, Math.PI*2);
      ctx.fillStyle = "#c73652";
      ctx.fill();

      // Eyes
      const eyeY = cy - 8;
      const eyeH = eyeBlink > 0.8 ? 2 : 10 * (1 - eyeBlink * 0.9);
      [cx-18, cx+18].forEach(ex => {
        ctx.beginPath();
        ctx.ellipse(ex, eyeY, 9, eyeH, 0, 0, Math.PI*2);
        ctx.fillStyle = "white";
        ctx.fill();
        if (eyeH > 3) {
          ctx.beginPath();
          ctx.arc(ex + 2, eyeY + 1, 5, 0, Math.PI*2);
          ctx.fillStyle = "#1a1a2e";
          ctx.fill();
          ctx.beginPath();
          ctx.arc(ex + 3, eyeY, 2, 0, Math.PI*2);
          ctx.fillStyle = "white";
          ctx.fill();
        }
      });

      // Eyebrows
      ctx.strokeStyle = "#92400e";
      ctx.lineWidth   = 2.5;
      ctx.lineCap     = "round";
      [cx-18, cx+18].forEach((ex, i) => {
        ctx.beginPath();
        ctx.moveTo(ex - 10, eyeY - 15);
        ctx.quadraticCurveTo(ex, eyeY - 18, ex + 10, eyeY - 15);
        ctx.stroke();
      });

      // Nose
      ctx.beginPath();
      ctx.moveTo(cx - 4, cy + 5);
      ctx.quadraticCurveTo(cx - 6, cy + 15, cx, cy + 17);
      ctx.quadraticCurveTo(cx + 6, cy + 15, cx + 4, cy + 5);
      ctx.strokeStyle = "#92400e55";
      ctx.lineWidth   = 1.5;
      ctx.stroke();

      // Mouth
      const mo = mouthOpen;
      ctx.beginPath();
      ctx.moveTo(cx - 18, cy + 26);
      ctx.quadraticCurveTo(cx, cy + 30 + mo * 8, cx + 18, cy + 26);
      ctx.strokeStyle = "#92400e";
      ctx.lineWidth   = 2.5;
      ctx.stroke();
      if (mo > 0.3) {
        ctx.beginPath();
        ctx.moveTo(cx - 14, cy + 27);
        ctx.quadraticCurveTo(cx, cy + 30 + mo * 8, cx + 14, cy + 27);
        ctx.fillStyle = "#c0392b";
        ctx.fill();
        ctx.beginPath();
        ctx.moveTo(cx - 10, cy + 27);
        ctx.quadraticCurveTo(cx, cy + 24, cx + 10, cy + 27);
        ctx.fillStyle = "#f1c0c0";
        ctx.fill();
      }

      // Mustache
      ctx.fillStyle = "#5d3a1a";
      [cx-12, cx+2].forEach(mx => {
        ctx.beginPath();
        ctx.ellipse(mx+5, cy+22, 9, 4, mx < cx ? 0.4 : -0.4, 0, Math.PI*2);
        ctx.fill();
      });

      // Collar
      ctx.beginPath();
      ctx.moveTo(cx-30, 140);
      ctx.lineTo(cx-20, cy+55);
      ctx.lineTo(cx, cy+52);
      ctx.lineTo(cx+20, cy+55);
      ctx.lineTo(cx+30, 140);
      ctx.fillStyle = "#1a5276";
      ctx.fill();
    }

    function avatarLoop() {
      headBob  += 0.02;
      blinkTimer++;
      if (blinkTimer > 180) { eyeBlink = 1; }
      if (blinkTimer > 190) { eyeBlink = 0; blinkTimer = 0; }

      // Mouth animation from audio
      if (currentAudio && !currentAudio.paused) {
        mouthOpen = 0.4 + 0.6 * Math.abs(Math.sin(Date.now() / 80));
        document.getElementById("speakingDot").classList.add("active");
      } else {
        mouthOpen = Math.max(0, mouthOpen - 0.08);
        if (mouthOpen < 0.05) {
          document.getElementById("speakingDot").classList.remove("active");
        }
      }

      drawAvatar();
      requestAnimationFrame(avatarLoop);
    }
    avatarLoop();

    // ===== VOICE INPUT =====
    let recognition = null;
    let isListening = false;

    function toggleMic() {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        alert("‡§Ü‡§™‡§ï‡§æ browser Voice Input support ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ‡•§ Chrome use ‡§ï‡§∞‡•ã‡•§"); return;
      }
      if (isListening) {
        recognition.stop(); return;
      }
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.lang        = 'hi-IN';
      recognition.interimResults = true;
      recognition.maxAlternatives = 1;

      recognition.onstart = () => {
        isListening = true;
        document.getElementById("micBtn").classList.add("listening");
        document.getElementById("micBtn").innerText = "‚èπ";
        document.getElementById("micStatus").style.display = "block";
      };
      recognition.onresult = (e) => {
        const transcript = Array.from(e.results).map(r => r[0].transcript).join('');
        document.getElementById("questionInput").value = transcript;
      };
      recognition.onend = () => {
        isListening = false;
        document.getElementById("micBtn").classList.remove("listening");
        document.getElementById("micBtn").innerText = "üé§";
        document.getElementById("micStatus").style.display = "none";
        // Auto ask if something was spoken
        if (document.getElementById("questionInput").value.trim()) askTeacher();
      };
      recognition.onerror = (e) => {
        isListening = false;
        document.getElementById("micBtn").classList.remove("listening");
        document.getElementById("micBtn").innerText = "üé§";
        document.getElementById("micStatus").style.display = "none";
      };
      recognition.start();
    }

    // ===== ASK TEACHER =====
    let currentAudio = null;

    async function askTeacher() {
      const question = document.getElementById("questionInput").value.trim();
      if (!question) return;

      document.getElementById("answerSection").style.display = "block";
      document.getElementById("answerText").innerHTML = '<div style="display:flex;align-items:center;gap:10px"><div class="spinner"></div> ‡§∏‡•ã‡§ö ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç...</div>';
      document.getElementById("searchSource").innerText = "";

      autoSearch(question);

      try {
        const data = await api("/ask", "POST", { question });
        const answer = data.answer || data.error || "‡§ú‡§µ‡§æ‡§¨ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ";
        document.getElementById("answerText").innerText = answer;
        if (data.source) document.getElementById("searchSource").innerText = "üîç " + data.source;

        // Audio alag fetch karo (non-blocking)
        fetch(`${BACKEND}/tts`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: answer.substring(0, 300) })
        }).then(r => r.json()).then(d => {
          if (d.audio) playAudio(d.audio);
        }).catch(() => {});

      } catch (e) {
        document.getElementById("answerText").innerHTML = '‚ùå Backend ‡§∏‡•á connect ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§™‡§æ‡§Ø‡§æ‡•§ <button class="btn btn-sm btn-primary" onclick="askTeacher()" style="margin-left:10px">üîÑ Retry</button>';
      }
    }

    // ===== AUDIO =====
    function playAudio(b64) {
      if (currentAudio) { currentAudio.pause(); currentAudio = null; }
      currentAudio = new Audio("data:audio/mp3;base64," + b64);
      currentAudio.playbackRate = 1.2;
      currentAudio.play().catch(() => {});
    }

    function replayAudio() { if (currentAudio) { currentAudio.currentTime = 0; currentAudio.play(); } }
    function stopAudio()   { if (currentAudio) { currentAudio.pause(); currentAudio.currentTime = 0; } }

    function speakBrowser() {
      const text = document.getElementById("answerText").innerText;
      if (!text) return;
      window.speechSynthesis.cancel();
      const utt   = new SpeechSynthesisUtterance(text);
      const voices = window.speechSynthesis.getVoices();
      const hi    = voices.find(v => v.lang === "hi-IN") || voices.find(v => v.lang.startsWith("hi"));
      if (hi) utt.voice = hi;
      utt.lang  = "hi-IN";
      utt.rate  = 0.9;
      utt.pitch = 1;
      window.speechSynthesis.speak(utt);
    }

    // ===== SEARCH =====
    async function autoSearch(query) {
      document.getElementById("searchInput").value = query;
      document.getElementById("searchResults").style.display = "block";
      document.getElementById("searchResults").innerHTML = `<div style="color:var(--muted);font-size:14px;padding:10px">üîç "${query}" search ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>`;
      await fetchSearch(query);
    }

    async function doSearch() {
      const query = document.getElementById("searchInput").value.trim();
      if (!query) return;
      document.getElementById("searchResults").style.display = "block";
      document.getElementById("searchResults").innerHTML = `<div style="color:var(--muted);font-size:14px;padding:10px">üîç "${query}" search ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>`;
      await fetchSearch(query);
    }

    async function fetchSearch(query) {
      try {
        const data = await api("/search", "POST", { query });
        const box  = document.getElementById("searchResults");
        if (!data.results?.length) {
          box.innerHTML = `<div style="color:var(--muted);font-size:14px;padding:10px">üòî ‡§ï‡•ã‡§à result ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§</div>`;
          return;
        }
        box.innerHTML = `<div style="font-size:12px;color:var(--muted);margin-bottom:10px">üîç ${data.results.length} results ‚Äî ${data.source || ""}</div>`;
        data.results.forEach(r => {
          const d = document.createElement("div");
          d.className = `search-item${r.is_wiki ? " wiki" : ""}`;
          d.innerHTML = `
            ${r.is_wiki ? '<span class="wiki-badge">üìñ Wikipedia</span><br>' : ""}
            <h4>${r.title || "No Title"}</h4>
            <p>${r.snippet || ""}</p>
            <a href="${r.url}" target="_blank" rel="noopener">${r.url}</a>
          `;
          d.onclick = (e) => { if (!e.target.closest("a")) window.open(r.url, "_blank"); };
          box.appendChild(d);
        });
      } catch {
        document.getElementById("searchResults").innerHTML = `<div style="color:var(--muted);font-size:14px;padding:10px">‚ùå Search ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§™‡§æ‡§à‡•§</div>`;
      }
    }

    // ===== ENTER KEY =====
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("questionInput").addEventListener("keypress", e => { if (e.key==="Enter") askTeacher(); });
      document.getElementById("searchInput").addEventListener("keypress",   e => { if (e.key==="Enter") doSearch(); });
    });
  </script>
</body>
</html>
